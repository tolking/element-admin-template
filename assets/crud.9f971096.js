var G=Object.defineProperty,K=Object.defineProperties;var M=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var C=(u,t,e)=>t in u?G(u,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):u[t]=e,q=(u,t)=>{for(var e in t||(t={}))O.call(t,e)&&C(u,e,t[e]);if(R)for(var e of R(t))S.call(t,e)&&C(u,e,t[e]);return u},E=(u,t)=>K(u,M(t));import{a as j,b as z,c as p,d as h,R as _,r as I,e as H,f as J,g as N,h as Q,i as U}from"./index.13915992.js";import{r as f,c as A,u as i,w as P}from"./modules-vue.24cc355b.js";const ee={login:"/admin/login",user:"/admin/user",userStatus:"/admin/user/{id}/status",article:"/admin/article",goods:"/admin/goods",cates:"/admin/goods/cates",form:"/admin/form"};function V({url:u,transform:t,showTip:e=!0,type:a="post"}){const n=f(!1),c=f({}),s=A(()=>t?t(i(c)):c.value),l=A(()=>I(i(u),s.value.id)),o=j(u,s),r=z(l,s),w=async(g,v)=>{if(v){const m=await F();m.value?i(e)&&p("success","\u63D0\u4EA4\u6210\u529F\uFF01"):m.value!==null&&i(e)&&p("warning","\u63D0\u4EA4\u5931\u8D25\uFF01")}g()};async function F(g=a){return n.value=!0,i(g)==="post"?(await o.execute(),n.value=!1,o.data):(await r.execute(),n.value=!1,r.data)}return{isFetching:n,form:c,submit:w,submitForm:F}}function W({url:u,immediate:t=!0}){const e=f(void 0),a=A(()=>I(i(u),e.value)),{isFetching:n,data:c,execute:s}=h(a);i(t)&&P(e,o=>{o!==void 0&&l()});async function l(){n.value||await s()}return{isFetching:n,detailId:e,detail:c,loadDetail:l}}function X({url:u,immediate:t=!1,showTip:e=!0}){const a=f(void 0),n=A(()=>I(i(u),a.value)),{isFetching:c,data:s,execute:l}=H(n);i(t)&&P(a,r=>{r!==void 0&&o()});function o(){return J("\u8B66\u544A","\u60A8\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u9879\u5417?",{type:"warning"}).then(async()=>(await l(),s.value?(a.value=void 0,i(e)&&p("success","\u5220\u9664\u6210\u529F!")):i(e)&&p("warning","\u5220\u9664\u5931\u8D25!"),s)).catch(()=>{a.value=void 0,p("info","\u5DF2\u53D6\u6D88\u64CD\u4F5C")})}return{isFetching:c,deleteId:a,submitDelete:o}}function Y({url:u,transform:t,immediate:e=!0}){const a=f(_),n=f(N),c=f(0),s=f({}),l=A(()=>{const m=t?t(i(s)):s.value;return E(q({},m),{[Q]:a.value,[U]:n.value})}),{isFetching:o,data:r,execute:w}=h(u,l),F=f([]),g=async(m,x)=>{x&&(a.value=_,await v()),m()};i(e)&&v();async function v(){o.value||(await w(),r.value&&(F.value=r.value.list,c.value=r.value.total))}return{query:s,isFetching:o,page:a,limit:n,total:c,list:F,search:g,loadList:v}}function te({url:u,immediate:t=!0,showTip:e=!0,syncDetail:a=!1,transform:n,transformQuery:c,transformDetail:s}){const l=Y({url:u,immediate:t,transform:c}),{form:o,submitForm:r}=V({url:u,showTip:e,transform:n}),{deleteId:w,submitDelete:F}=X({url:u,showTip:e}),{detailId:g,detail:v,loadDetail:m}=W({url:u,immediate:!1}),x=async(b,y,D)=>{if(y==="edit"||y==="detail"){let d=q({},D);i(a)&&(d==null?void 0:d.id)&&(g.value=d.id,await m(),v.value&&(d=v.value)),o.value=s?s(d):d}b()},B=async(b,y,D,d)=>{if(d){const L=await r(D==="add"?"post":"put");L.value?(e&&p("success","\u63D0\u4EA4\u6210\u529F\uFF01"),l.loadList(),b()):L.value!==null&&e&&p("warning","\u63D0\u4EA4\u5931\u8D25\uFF01")}y()};async function k(b){const y=b;w.value=y.id;const D=await F();D!=null&&D.value&&l.loadList()}return E(q({},l),{form:o,beforeOpen:x,submit:B,submitForm:r,deleteRow:k})}export{ee as A,Y as a,W as b,te as c,V as u};
