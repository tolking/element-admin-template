/* empty css             *//* empty css                  */import{a9 as C,aa as E}from"./modules-element-plus-92389d6d.js";import{i as M,A,m as B,n as x}from"./modules-vueuse-9b2c2f8a.js";import{R as G,u as $,a as S,b as H,c as K}from"./store-094d7e77.js";import{c as _,u as i,ay as Q,a as f,f as D}from"./modules-vue-596fe172.js";import{r as z}from"./index-b2df5dea.js";function v(e,t,s={}){return C(Object.assign(s,{type:e,message:t}))}function N(e,t,s={}){return E.confirm(e,t,s)}function U(e){return/\/$/.test(e)?e:e+"/"}function I(e,...t){const[s,...n]=t;if(s!==void 0&&/\{\w*\}/.test(e))e=e.replace(/\{\w*\}/,String(s));else if(s!==void 0)e=U(e)+s;else return e;return I(e,...n)}function V(){M&&window.scrollTo({left:0,top:0,behavior:"smooth"})}const W="https://api.virapi.com/vir_github21e78h6b5d24e",O=A({baseUrl:W,options:{immediate:!1,timeout:G,beforeFetch({options:e}){return $(),e.headers=Object.assign(e.headers||{},{"app-token":"$2a$10$oWYgEw/X1hj9BbvejQOud.xFezq5wP8H7NGkVA.4HcChK928Z2nja"}),{options:e}},afterFetch({data:e,response:t}){const s=$(),n=e.code;return n===200?e=e.data||{}:n===401?(s.value={token:"",name:"",avatar:""},v("warning","登陆已经过期"),setTimeout(()=>{z.push("/login")},1500),e=null):n===1e3?(console.error(e.message),v("warning",e.message),e=null):n&&(console.log("出现未全局拦截错误"),e=void 0),{data:e,response:t}},onFetchError({data:e,error:t}){return console.error(t),e=void 0,{data:e,error:t}}},fetchOptions:{mode:"cors",credentials:"same-origin"}});function L(e,t){const s=_(()=>{const n=i(e),a=i(t),o=B(a)?Q(a):a||"";return`${n}${o?"?":""}${o}`});return O(s).json()}function X(e,t){return O(e).post(t).json()}function Y(e,t){return O(e).put(t).json()}function Z(e,t){return O(e).delete(t).json()}function J({url:e,transform:t,showTip:s=!0,type:n="post",afterSubmit:a}){const o=f(!1),u=f({}),c=f({}),r=_(()=>I(i(e),c.value.id)),l=X(e,c),g=Y(r,c),b=async(m,y)=>{if(y){const w=await F();w.value?i(s)&&v("success","提交成功！"):w.value!==null&&i(s)&&v("warning","提交失败！"),x(a)&&a(w.value)}m()};async function F(m=n){return p(),o.value=!0,i(m)==="post"?(await l.execute(),o.value=!1,l.data):(await g.execute(),o.value=!1,g.data)}function p(){c.value=x(t)?t(i(u)):u.value}return{isFetching:o,form:u,submit:b,submitForm:F}}function T({url:e,immediate:t=!0}){const s=f(void 0),n=_(()=>I(i(e),s.value)),{isFetching:a,data:o,execute:u}=L(n);i(t)&&D(s,r=>{r!==void 0&&c()});async function c(){a.value||await u()}return{isFetching:a,detailId:s,detail:o,loadDetail:c}}function ee({url:e,immediate:t=!1,showTip:s=!0}){const n=f(void 0),a=_(()=>I(i(e),n.value)),{isFetching:o,data:u,execute:c}=Z(a);i(t)&&D(n,l=>{l!==void 0&&r()});function r(){return N("警告","您确定要删除该项吗?",{type:"warning"}).then(async()=>(await c(),u.value?(n.value=void 0,i(s)&&v("success","删除成功!")):i(s)&&v("warning","删除失败!"),u)).catch(()=>{n.value=void 0,v("info","已取消操作")})}return{isFetching:o,deleteId:n,submitDelete:r}}function te({url:e,transform:t,immediate:s=!0}){const n=f(1),a=f(S),o=f(0),u=f({}),c=f({}),{isFetching:r,data:l,execute:g}=L(e,c),b=f([]),F=async(y,w)=>{w&&(n.value=1,await p()),y()};i(s)&&p();async function p(){r.value||(m(),await g(),l.value&&(V(),b.value=l.value.list,o.value=l.value.total))}function m(){const y=x(t)?t(i(u)):u.value;c.value={...y,[H]:n.value,[K]:a.value}}return{query:u,isFetching:r,page:n,limit:a,total:o,list:b,search:F,loadList:p}}function re({url:e,immediate:t=!0,showTip:s=!0,syncDetail:n=!1,transform:a,transformQuery:o,transformDetail:u,afterSubmit:c}){const r=te({url:e,immediate:t,transform:o}),{form:l,submitForm:g}=J({url:e,showTip:s,transform:a}),{deleteId:b,submitDelete:F}=ee({url:e,showTip:s}),{detailId:p,detail:m,loadDetail:y}=T({url:e,immediate:!1}),w=async(q,j,h)=>{if(j==="edit"||j==="detail"){let d={...h};i(n)&&(d!=null&&d.id)&&(p.value=d.id,await y(),m.value&&(d=m.value)),l.value=x(u)?u(d):d}else l.value={};q()},P=async(q,j,h,d)=>{if(d){const R=await g(h==="add"?"post":"put");R.value?(s&&v("success","提交成功！"),r.loadList(),q()):R.value!==null&&s&&v("warning","提交失败！"),x(c)&&c(R.value)}j()};async function k(q){const j=q;b.value=j.id;const h=await F();h!=null&&h.value&&r.loadList()}return{...r,form:l,beforeOpen:w,submit:P,submitForm:g,deleteRow:k}}const le={login:"/admin/login",user:"/admin/user",userStatus:"/admin/user/{id}/status",article:"/admin/article",goods:"/admin/goods",cates:"/admin/goods/cates",form:"/admin/form"};export{le as A,te as a,v as b,T as c,re as d,L as e,J as u};
