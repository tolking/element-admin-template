var k=Object.defineProperty,G=Object.defineProperties;var K=Object.getOwnPropertyDescriptors;var q=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var C=(u,t,e)=>t in u?k(u,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):u[t]=e,I=(u,t)=>{for(var e in t||(t={}))M.call(t,e)&&C(u,e,t[e]);if(q)for(var e of q(t))O.call(t,e)&&C(u,e,t[e]);return u},L=(u,t)=>G(u,K(t));import{a as S,b as j,c as D,d as R,r as _,e as z,f as H,R as J,g as N,h as Q}from"./index.435bde2b.js";import{r as d,c as x,u as i,w as h}from"./modules-vue.24cc355b.js";const T={login:"/admin/login",user:"/admin/user",userStatus:"/admin/user/{id}/status",article:"/admin/article",goods:"/admin/goods",cates:"/admin/goods/cates",form:"/admin/form"};function U({url:u,transform:t,showTip:e=!0,type:a="post"}){const n=d(!1),c=d({}),s=x(()=>t?t(i(c)):c.value),l=x(()=>_(i(u),s.value.id)),o=S(u,s),r=j(l,s),y=async(g,f)=>{if(f){const v=await F();v.value?i(e)&&D("success","\u63D0\u4EA4\u6210\u529F\uFF01"):v.value!==null&&i(e)&&D("warning","\u63D0\u4EA4\u5931\u8D25\uFF01")}g()};async function F(g=a){return n.value=!0,i(g)==="post"?(await o.execute(),n.value=!1,o.data):(await r.execute(),n.value=!1,r.data)}return{isFetching:n,form:c,submit:y,submitForm:F}}function V({url:u,immediate:t=!0}){const e=d(void 0),a=x(()=>_(i(u),e.value)),{isFetching:n,data:c,execute:s}=R(a);i(t)&&h(e,o=>{o!==void 0&&l()});async function l(){n.value||await s()}return{isFetching:n,detailId:e,detail:c,loadDetail:l}}function W({url:u,immediate:t=!1,showTip:e=!0}){const a=d(void 0),n=x(()=>_(i(u),a.value)),{isFetching:c,data:s,execute:l}=z(n);i(t)&&h(a,r=>{r!==void 0&&o()});function o(){return H("\u8B66\u544A","\u60A8\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u9879\u5417?",{type:"warning"}).then(async()=>(await l(),s.value?(a.value=void 0,i(e)&&D("success","\u5220\u9664\u6210\u529F!")):i(e)&&D("warning","\u5220\u9664\u5931\u8D25!"),s)).catch(()=>{a.value=void 0,D("info","\u5DF2\u53D6\u6D88\u64CD\u4F5C")})}return{isFetching:c,deleteId:a,submitDelete:o}}function X({url:u,transform:t,immediate:e=!0}){const a=d(1),n=d(J),c=d(0),s=d({}),l=x(()=>{const v=t?t(i(s)):s.value;return L(I({},v),{[N]:a.value,[Q]:n.value})}),{isFetching:o,data:r,execute:y}=R(u,l),F=d([]),g=async(v,E)=>{E&&(a.value=1,await f()),v()};i(e)&&f();async function f(){o.value||(await y(),r.value&&(F.value=r.value.list,c.value=r.value.total))}return{query:s,isFetching:o,page:a,limit:n,total:c,list:F,search:g,loadList:f}}function ee({url:u,immediate:t=!0,showTip:e=!0,syncDetail:a=!1,transform:n,transformQuery:c,transformDetail:s}){const l=X({url:u,immediate:t,transform:c}),{form:o,submitForm:r}=U({url:u,showTip:e,transform:n}),{deleteId:y,submitDelete:F}=W({url:u,showTip:e}),{detailId:g,detail:f,loadDetail:v}=V({url:u,immediate:!1}),E=async(w,p,m)=>{if(p==="edit"||p==="detail"){let b=m;if(i(a)){const A=m;A.id&&(g.value=A.id,await v(),f.value&&(b=f.value))}o.value=s?s(b):b}w()},B=async(w,p,m,b)=>{if(b){const A=await r(m==="add"?"post":"put");A.value?(e&&D("success","\u63D0\u4EA4\u6210\u529F\uFF01"),l.loadList(),w()):A.value!==null&&e&&D("warning","\u63D0\u4EA4\u5931\u8D25\uFF01")}p()};async function P(w){const p=w;y.value=p.id;const m=await F();m!=null&&m.value&&l.loadList()}return L(I({},l),{form:o,beforeOpen:E,submit:B,submitForm:r,deleteRow:P})}export{T as A,X as a,V as b,ee as c,U as u};
