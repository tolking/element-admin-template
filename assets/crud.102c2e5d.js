var G=Object.defineProperty,I=Object.defineProperties;var K=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var _=(t,e,u)=>e in t?G(t,e,{enumerable:!0,configurable:!0,writable:!0,value:u}):t[e]=u,L=(t,e)=>{for(var u in e||(e={}))M.call(e,u)&&_(t,u,e[u]);if(R)for(var u of R(e))O.call(e,u)&&_(t,u,e[u]);return t},q=(t,e)=>I(t,K(e));import{a as S,b as U,c as F,d as h,e as j,f as z,r as C,R as H,g as J,h as N}from"./index.a59d0955.js";import{r as d,c as b,u as y}from"./modules-vue.3bc0effc.js";const $={login:"/admin/login",user:"/admin/user",userStatus:"/admin/user/{id}/status",article:"/admin/article"};function Q({url:t,transform:e,showTip:u=!0,type:c="post"}){const a=d(!1),i=d({}),s=b(()=>e?e(y(i)):i.value),n=b(()=>C(y(t),s.value.id)),o=S(t,s),l=U(n,s),p=async(v,m)=>{if(m){const f=await r();f.value?u&&F("success","\u63D0\u4EA4\u6210\u529F!"):f.value!==null&&u&&F("warning","\u63D0\u4EA4\u5931\u8D25!")}v()};async function r(v=c){return a.value=!0,v==="post"?(await o.execute(),a.value=!1,o.data):(await l.execute(),a.value=!1,l.data)}return{isFetching:a,form:i,submit:p,submitForm:r}}function V({url:t,id:e,immediate:u=!0}){const c=b(()=>C(y(t),y(e))),{isFetching:a,data:i,execute:s}=h(c);u&&n();async function n(){a.value||await s()}return{isFetching:a,detail:i,loadDetail:n}}function W({url:t,transform:e,immediate:u=!0}){const c=d(1),a=d(N),i=d(0),s=d({}),n=b(()=>{const f=e?e(y(s)):s.value;return q(L({},f),{[H]:c.value,[J]:a.value})}),{isFetching:o,data:l,execute:p}=h(t,n),r=d([]),v=async(f,E)=>{E&&(c.value=1,await m()),f()};u&&m();async function m(){o.value||(await p(),l.value&&(r.value=l.value.list,i.value=l.value.total))}return{query:s,isFetching:o,page:c,limit:a,total:i,list:r,search:v,loadList:m}}function T({url:t,immediate:e=!0,showTip:u=!0,syncDetail:c=!1,transform:a,transformQuery:i,transformDetail:s}){const n=d(void 0),o=W({url:t,immediate:e,transform:i}),{form:l,submitForm:p}=Q({url:t,transform:a}),{detail:r,loadDetail:v}=V({url:t,id:n,immediate:!1}),m=b(()=>C(y(t),n.value)),{data:f,execute:E}=j(m),B=async(D,g,x)=>{if(g==="edit"){let w=x;if(c){const A=x;A.id&&(n.value=A.id,await v(),r.value&&(w=r.value))}l.value=s?s(w):w}D()},P=async(D,g,x,w)=>{if(w){const A=await p(x==="add"?"post":"put");A.value?(u&&F("success","\u63D0\u4EA4\u6210\u529F\uFF01"),o.loadList(),D()):A.value!==null&&u&&F("warning","\u63D0\u4EA4\u5931\u8D25\uFF01")}g()};function k(D){z("\u60A8\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u9879\u5417\uFF1F","\u8B66\u544A",{type:"warning"}).then(async()=>{const g=D;n.value=g.id,await E(),f.value?(u&&F("success","\u5220\u9664\u6210\u529F"),o.loadList()):u&&F("warning","\u5220\u9664\u5931\u8D25")}).catch(()=>{F("info","\u5DF2\u53D6\u6D88\u64CD\u4F5C")})}return q(L({},o),{form:l,beforeOpen:B,submit:P,submitForm:p,deleteRow:k})}export{$ as A,W as a,T as b,Q as u};
